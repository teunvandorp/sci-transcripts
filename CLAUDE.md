# CLAUDE.md

This file provides guidance to Claude Code (claude.ai/code) when working with code in this repository.

## Project Overview

This repository contains lecture transcripts for the course "Statistical and Causal Inference", part of the Data Science master program at Radboud University, Nijmegen, taught by Johannes Textor. These are edited transcripts of live lectures, not a textbook, and may contain inaccuracies characteristic of natural speech.

The transcripts are generated by combining AI-generated transcriptions (via OpenAI Whisper) with lecture notes (Markdown files used during lectures). The instructor manually edits transcripts without AI assistance, then uses Claude Sonnet 4.5 for proofreading and generating formative questions.

## Build System

### Building the book

```bash
make all
```

This renders the book as HTML output in `_book/index.html`.

### Build process

The build uses a two-stage process:

1. **Preprocessing**: Source Markdown files in `src/` are converted to R Markdown (`.Rmd`) files using `clean_for_rmd.py`
2. **Rendering**: Bookdown renders the `.Rmd` files into a GitBook-style HTML book

The preprocessing script (`clean_for_rmd.py`) performs these operations:
- Removes automatically inserted code outputs (non-R code blocks)
- Removes plot references (`![Plot](...)`
- Adds an R setup chunk after the first heading with plotting defaults
- Preserves R code blocks (starting with `` ```{r ``)

### File workflow

- Source files: `src/lecture-*.md` (raw Markdown transcripts)
- Processed files: `lecture-*.Rmd` (cleaned, ready for knitr/bookdown)
- Configuration: `_bookdown.yml` (controls which files are included)
- Index/frontmatter: `index.Rmd`

Note: `lecture-1.md` is already in the root directory and doesn't go through preprocessing (it may be a special case or legacy file).

## Project Structure

```
.
├── _bookdown.yml       # Bookdown configuration (chapter ordering)
├── index.Rmd           # Book frontmatter and introduction
├── Makefile            # Build automation
├── clean_for_rmd.py    # Preprocessing script for source files
├── src/                # Raw Markdown transcripts
│   └── lecture-*.md
├── lecture-*.Rmd       # Processed R Markdown files (generated)
└── _book/              # Compiled HTML output (generated)
```

## Working with Lectures

### Adding new lectures

1. Place raw transcript in `src/lecture-N.md` (or `src/lecture-Nb.md` for continuation lectures)
2. Add the corresponding `.Rmd` file to `_bookdown.yml` in the `rmd_files` list
3. Add a build rule to the Makefile (follows pattern: `lecture-%.Rmd :src/lecture-%.md clean_for_rmd.py`)
4. Run `make all` to rebuild

### Editing existing lectures

- Edit source files in `src/` (for lectures 2+)
- Edit `lecture-1.md` directly (it's in the root)
- The `.Rmd` files are generated artifacts — don't edit them directly

### R code blocks

R code blocks in transcripts should use the format:
```r
\`\`\`{r optional-chunk-name}
# R code here
\`\`\`
```

These will be preserved during preprocessing and executed by knitr during rendering.

## Course Content Structure

The course covers:
1. **Quarter 1**: Statistical inference (hypothesis testing, parameter estimation, regression models)
2. **Quarter 2**: Causal inference

Key topics include:
- Philosophy of science (deductive vs. inductive reasoning, Popper's falsificationism)
- Statistical vs. causal inference
- Linear regression (conditional probability models, loss functions)
- Frequentist vs. Bayesian approaches
- Probability distributions and conditional expectations

## Development Notes

- Lectures include formative "Test your understanding" questions at the end
- Student questions/comments are formatted as blockquotes in Markdown
- The transcripts shift style from lightly edited (early chapters) to more heavily edited (later chapters)
- Code in `clean_for_rmd.py` was written by Claude Sonnet 3.5
